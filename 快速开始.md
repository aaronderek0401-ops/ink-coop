# 🚀 快速开始 - 字体和图片库管理

## 第一步：启动服务

打开终端（PowerShell），运行：

```powershell
cd G:\A_BL_Project\inkScree_fuben
python tools/ttf_to_gfx_webservice.py
```

看到以下输出表示成功：
```
============================================================
TTF 转 GFX Web 服务启动中...
============================================================
访问: http://localhost:5000
API 端点:
  - 列出字体库: http://localhost:5000/list_fonts
  - 列出图片库: http://localhost:5000/list_bitmaps
  - 获取位图预览: http://localhost:5000/get_bitmap_preview
============================================================
```

⚠️ **保持此终端窗口打开！**

## 第二步：打开网页

1. 找到文件：`components\grbl_esp32s3\Grbl_Esp32\data\web_layout.html`
2. 用浏览器打开（推荐 Chrome 或 Edge）

## 第三步：管理字体库

### 查看已有字体
1. 滚动到 **TTF 字体管理** 部分
2. 找到 **📚 字体库管理** 区域
3. 点击 **🔍 查询字体库** 按钮
4. 查看 `components/fonts/` 下的所有字体文件

### 导入字体到程序
1. 在字体列表中找到需要的字体（例如 `fangsong16pt_bitmaps.h`）
2. 点击 **导入** 按钮
3. 点击确认
4. **include 路径已自动复制到剪贴板！**
5. 打开 `ink_screen.cpp`，在文件顶部粘贴：
   ```cpp
   #include "../fonts/fangsong16pt_bitmaps.h"
   ```
6. 在显示函数中添加绘制代码：
   ```cpp
   drawFangsongString(display, 10, 50, "你好世界");
   ```

## 第四步：管理图片库

### 上传新图片并保存
1. 滚动到 **📷 图片转位图** 部分
2. 点击 **选择图片文件**，上传一张图片（JPG/PNG）
3. 调整宽度和高度（建议不超过 200x200）
4. 选择处理模式（推荐 **抖动算法**）
5. 点击 **预览处理效果** 查看黑白效果
6. 点击 **转换为位图数组**
7. 点击 **💾 保存到服务器** ⭐
8. 看到"✅ 位图文件已保存到服务器"表示成功
9. 文件保存在 `components/bitmap/` 文件夹

### 查看已有图片
1. 在 **🖼️ 图片库管理** 区域
2. 点击 **🔍 查询图片库** 按钮
3. 查看 `components/bitmap/` 下的所有位图文件

### 预览图片
1. 在图片列表中找到某个位图
2. 点击 **预览** 按钮
3. 在下方查看黑白预览效果
4. 查看尺寸和字节数信息

### 导入图片到程序
1. 在图片列表中找到需要的位图（例如 `logo_bitmap.h`）
2. 点击 **导入** 按钮
3. 点击确认
4. **include 路径已自动复制到剪贴板！**
5. 打开 `ink_screen.cpp`，在文件顶部粘贴：
   ```cpp
   #include "../bitmap/logo_bitmap.h"
   ```
6. 在显示函数中添加绘制代码：
   ```cpp
   display.drawBitmap(10, 50, IMAGE_BITMAP, IMAGE_WIDTH, IMAGE_HEIGHT, GxEPD_BLACK);
   ```

## 第五步：编译和上传

1. 在 VS Code 中按 `Ctrl+Shift+P`
2. 选择 **ESP-IDF: Build your project**
3. 编译成功后选择 **ESP-IDF: Flash your project**
4. 等待上传完成
5. 查看墨水屏显示效果

## 💡 小贴士

### 字体管理
- ✅ 中文字体推荐使用 **Python 高质量位图** 格式
- ✅ 字体文件命名建议包含字号（如 `fangsong16pt`）
- ✅ 定期清理不使用的字体文件

### 图片管理
- ✅ 照片推荐使用 **抖动算法** 处理
- ✅ Logo/图标推荐使用 **阈值二值化** 处理
- ✅ 图片尺寸建议不超过墨水屏分辨率
- ✅ 保存前先预览效果确认满意

### 常见问题
**Q: 点击查询没反应？**
A: 检查 Python 服务是否在运行（看第一步）

**Q: 显示"查询失败"？**
A: 确保 Python 服务正常启动，检查终端是否有错误

**Q: 如何查看 Python 服务日志？**
A: 看启动服务的终端窗口，会显示所有请求记录

**Q: 位图预览显示不正确？**
A: 检查 .h 文件是否包含正确的 `IMAGE_WIDTH` 和 `IMAGE_HEIGHT` 定义

## 📁 文件夹位置

```
G:\A_BL_Project\inkScree_fuben\
├── components\
│   ├── fonts\              ← 字体文件在这里
│   └── bitmap\             ← 图片位图在这里
├── tools\
│   └── ttf_to_gfx_webservice.py  ← 运行这个启动服务
└── components\grbl_esp32s3\Grbl_Esp32\
    ├── data\
    │   └── web_layout.html       ← 浏览器打开这个
    └── src\BL_add\ink_screen\
        └── ink_screen.cpp        ← 在这里添加代码
```

## ✅ 完成！

现在你可以：
- 🔍 查询和管理字体库
- 🔍 查询和管理图片库
- 👁️ 预览位图效果
- 📋 一键导入到程序
- 💾 保存到服务器

祝使用愉快！🎉
