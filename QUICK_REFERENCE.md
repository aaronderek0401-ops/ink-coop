# âš¡ Web é…ç½®ç³»ç»Ÿ - å¿«é€Ÿå‚è€ƒ

## ğŸ¯ æ ¸å¿ƒå˜æ›´

ä» ESP32 è®¾å¤‡ç«¯ç‚¹æ”¹ä¸ºæœ¬åœ° Python Flask æœåŠ¡å™¨

**æ—§æµç¨‹**: Web UI â†’ `/getfocusconfig` â†’ ESP32 â† éœ€è¦ç¼–è¯‘çƒ§å½•
**æ–°æµç¨‹**: Web UI â†’ `localhost:5001/api/config/focus` â†’ `components/resource/`

---

## ğŸ“ å…³é”®æ–‡ä»¶ä½ç½®

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ config_server.py                  # ğŸ‘ˆ å¯åŠ¨è¿™ä¸ª
â”œâ”€â”€ start_config_server.bat           # æˆ–è€…åŒå‡»è¿™ä¸ª (Windows)
â”œâ”€â”€ CONFIG_SERVER_README.md           # è¯¦ç»†ä½¿ç”¨è¯´æ˜
â”œâ”€â”€ TEST_CONFIG_SERVER.md             # æµ‹è¯•æŒ‡å—
â”œâ”€â”€ WEB_CONFIG_SYSTEM.md              # ç³»ç»Ÿæ€»ç»“
â”œâ”€â”€ IMPLEMENTATION_SUMMARY.md         # å®ç°ç»†èŠ‚
â”œâ”€â”€ IMPLEMENTATION_CHECKLIST.md       # æœ¬æ–‡ä»¶æ¸…å•
â”œâ”€â”€ init_resource.py                  # åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ compress_html.py                  # å‹ç¼©è„šæœ¬
â”‚
â”œâ”€â”€ components/
â”‚   â””â”€â”€ resource/                     # ğŸ‘ˆ é…ç½®æ–‡ä»¶å­˜åœ¨è¿™é‡Œ
â”‚       â”œâ”€â”€ main_focusable_rects_config.json
â”‚       â”œâ”€â”€ vocab_focusable_rects_config.json
â”‚       â”œâ”€â”€ main_subarray_config.json
â”‚       â””â”€â”€ vocab_subarray_config.json
â”‚
â””â”€â”€ components/grbl_esp32s3/Grbl_Esp32/data/
    â”œâ”€â”€ web_layout.html               # å·²ä¿®æ”¹ï¼šä½¿ç”¨ localhost:5001
    â””â”€â”€ web_layout.html.gz            # å·²é‡æ–°å‹ç¼©
```

---

## ğŸš€ 3 æ­¥å¿«é€Ÿå¯åŠ¨

### ç¬¬ 1 æ­¥ï¼šå¯åŠ¨æœåŠ¡å™¨ (ä»»é€‰å…¶ä¸€)

```bash
# é€‰é¡¹ A: å‘½ä»¤è¡Œ
python config_server.py

# é€‰é¡¹ B: Windows æ‰¹å¤„ç†
åŒå‡» start_config_server.bat
```

**éªŒè¯**: çœ‹åˆ°è¿™ä¸ªè¾“å‡ºè¯´æ˜æˆåŠŸ
```
Running on http://0.0.0.0:5001
```

### ç¬¬ 2 æ­¥ï¼šæ‰“å¼€ Web UI

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€:
```
file:///G:/A_BL_Project/inkScree_fuben/components/grbl_esp32s3/Grbl_Esp32/data/web_layout.html
```

### ç¬¬ 3 æ­¥ï¼šåŠ è½½é…ç½®

ç‚¹å‡» Web UI ä¸­çš„ "ä»è®¾å¤‡åŠ è½½ç„¦ç‚¹é…ç½®" æŒ‰é’®

âœ… å®Œæˆï¼ç°åœ¨å¯ä»¥ç¼–è¾‘å’Œä¿å­˜é…ç½®

---

## ğŸ“‹ å››å¤§ API ç«¯ç‚¹

| æ“ä½œ | ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|------|
| åŠ è½½ç„¦ç‚¹é…ç½® | `/api/config/focus?screen_type=main` | GET | è¯»å– JSON |
| ä¿å­˜ç„¦ç‚¹é…ç½® | `/api/config/focus` | POST | å†™å…¥ JSON |
| åŠ è½½å­æ•°ç»„é…ç½® | `/api/config/subarray?screen_type=main` | GET | è¯»å– JSON |
| ä¿å­˜å­æ•°ç»„é…ç½® | `/api/config/subarray` | POST | å†™å…¥ JSON |

### ç”¨ curl æµ‹è¯•

```bash
# è¯»å–ä¸»ç•Œé¢ç„¦ç‚¹é…ç½®
curl http://localhost:5001/api/config/focus?screen_type=main

# ä¿å­˜ä¸»ç•Œé¢ç„¦ç‚¹é…ç½®
curl -X POST http://localhost:5001/api/config/focus \
  -H "Content-Type: application/json" \
  -d '{"count":15,"focusable_indices":[0,1,2,...],"screen_type":"main"}'
```

---

## ğŸ” Web UI ä¸­å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

### åŠ è½½é…ç½®æ—¶

1. ç”¨æˆ·ç‚¹å‡» "ä»è®¾å¤‡åŠ è½½ç„¦ç‚¹é…ç½®"
2. Web UI å‘é€ GET è¯·æ±‚åˆ° `localhost:5001/api/config/focus?screen_type=main`
3. Flask æœåŠ¡å™¨è¯»å– `components/resource/main_focusable_rects_config.json`
4. è¿”å› JSON ç»™æµè§ˆå™¨
5. Web UI åŠ è½½é…ç½®åˆ°å†…å­˜ä¸­æ˜¾ç¤ºå¤é€‰æ¡†

### ä¿å­˜é…ç½®æ—¶

1. ç”¨æˆ·ç‚¹å‡» "ä¿å­˜ç„¦ç‚¹é…ç½®åˆ°è®¾å¤‡"
2. Web UI æ”¶é›†æ‰€æœ‰å¤é€‰æ¡†çŠ¶æ€
3. å‘é€ POST è¯·æ±‚åˆ° `localhost:5001/api/config/focus`
4. Flask æœåŠ¡å™¨å°† JSON å†™å…¥ `components/resource/main_focusable_rects_config.json`
5. æµè§ˆå™¨æ˜¾ç¤º "ä¿å­˜æˆåŠŸ" æ¶ˆæ¯

---

## âŒ å¸¸è§é—®é¢˜é€Ÿè§£

### é—®: "è¿æ¥è¢«æ‹’ç»" æˆ– "æ— æ³•è®¿é—®"

**ç­”**: æœåŠ¡å™¨æ²¡åœ¨è¿è¡Œï¼
```bash
python config_server.py
```
ç¡®ä¿çœ‹åˆ° `Running on http://0.0.0.0:5001`

### é—®: "åŠ è½½é…ç½®ä¸ºç©º"

**ç­”**: é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ã€‚åˆå§‹åŒ–ï¼š
```bash
python init_resource.py
```

### é—®: "CORS é”™è¯¯"

**ç­”**: Flask æœåŠ¡å™¨å·²å¯ç”¨ CORSï¼Œè¿™ä¸åº”è¯¥å‘ç”Ÿã€‚æ£€æŸ¥ï¼š
- æµè§ˆå™¨æ˜¯å¦é˜»æ­¢è·¨åŸŸè¯·æ±‚ï¼ˆåº”è¯¥ä¸ä¼šï¼‰
- æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­çš„å…·ä½“é”™è¯¯ä¿¡æ¯

### é—®: "æ–‡ä»¶æƒé™æ‹’ç»"

**ç­”**: `components/resource/` æ–‡ä»¶å¤¹æƒé™é—®é¢˜
```bash
# Windows: æ£€æŸ¥æ–‡ä»¶å¤¹å±æ€§ â†’ å®‰å…¨ â†’ ç¼–è¾‘æƒé™
# Linux/Mac: chmod 755 components/resource
```

### é—®: ä¿å­˜åé…ç½®æ–‡ä»¶ä¸ºç©ºæˆ–æ— æ•ˆ

**ç­”**: æ£€æŸ¥ `components/resource/` ä¸­çš„æ–‡ä»¶å†…å®¹
```bash
type components\resource\main_focusable_rects_config.json
```
åº”è¯¥çœ‹åˆ°æœ‰æ•ˆçš„ JSON æ•°æ®

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| Web UI æ–‡ä»¶å¤§å° | 247.7 KB (åŸå§‹) â†’ 39.5 KB (å‹ç¼©) |
| API å“åº”æ—¶é—´ | < 10ms |
| æ–‡ä»¶è¯»å– | < 5ms |
| æ–‡ä»¶å†™å…¥ | < 10ms |

---

## ğŸ”§ ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ· (ä½ )                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Web æµè§ˆå™¨                                          â”‚
â”‚  â”œâ”€â”€ web_layout.html (Web UI ç•Œé¢)                  â”‚
â”‚  â””â”€â”€ å‘é€ HTTP è¯·æ±‚åˆ° localhost:5001               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼ HTTP GET/POST
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Flask é…ç½®æœåŠ¡å™¨ (localhost:5001)                   â”‚
â”‚  â”œâ”€â”€ /api/config/focus                              â”‚
â”‚  â”œâ”€â”€ /api/config/subarray                           â”‚
â”‚  â””â”€â”€ /api/health                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼ æ–‡ä»¶ I/O
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  components/resource/ (æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ)                 â”‚
â”‚  â”œâ”€â”€ main_focusable_rects_config.json               â”‚
â”‚  â”œâ”€â”€ vocab_focusable_rects_config.json              â”‚
â”‚  â”œâ”€â”€ main_subarray_config.json                      â”‚
â”‚  â””â”€â”€ vocab_subarray_config.json                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š å®Œæ•´æ–‡æ¡£å¯¼èˆª

| æ–‡æ¡£æ–‡ä»¶ | ç”¨é€” | ä½•æ—¶é˜…è¯» |
|---------|------|---------|
| `CONFIG_SERVER_README.md` | è¯¦ç»†ä½¿ç”¨è¯´æ˜ | äº†è§£è¯¦ç»†ä¿¡æ¯ |
| `TEST_CONFIG_SERVER.md` | æµ‹è¯•å’Œæ•…éšœæ’æŸ¥ | é‡åˆ°é—®é¢˜æ—¶ |
| `WEB_CONFIG_SYSTEM.md` | ç³»ç»Ÿæ¶æ„æ€»ç»“ | ç†è§£æ•´ä½“è®¾è®¡ |
| `IMPLEMENTATION_SUMMARY.md` | å®ç°ç»†èŠ‚ | ç†è§£ä»£ç å˜æ›´ |
| `IMPLEMENTATION_CHECKLIST.md` | å®Œæ•´æ–‡ä»¶æ¸…å• | æœ¬æ–‡ä»¶ |
| **æœ¬æ–‡ä»¶** | å¿«é€Ÿå‚è€ƒ | æ—¥å¸¸ä½¿ç”¨å¿«æŸ¥ |

---

## âœ¨ ä¸»è¦ä¼˜åŠ¿

âœ… **æ— éœ€ç¼–è¯‘**: ä¿®æ”¹é…ç½®ä¸éœ€è¦é‡æ–°ç¼–è¯‘å’Œçƒ§å½•
âœ… **å¿«é€Ÿè¿­ä»£**: å³æ—¶ä¿å­˜å’ŒåŠ è½½
âœ… **ç‰ˆæœ¬æ§åˆ¶**: é…ç½®æ–‡ä»¶å¯ä»¥ Git è¿½è¸ª
âœ… **æ˜“äºå¤‡ä»½**: æ–‡ä»¶åœ¨é¡¹ç›®ç›®å½•ï¼Œå®¹æ˜“å¤‡ä»½
âœ… **æµè§ˆå™¨ç•Œé¢**: ç†Ÿæ‚‰çš„ Web æ“ä½œç•Œé¢

---

## ğŸ“ å­¦ä¹ è·¯å¾„

åˆæ¬¡ä½¿ç”¨ï¼ŸæŒ‰è¿™ä¸ªé¡ºåºï¼š

1. ğŸ“– æœ¬æ–‡ä»¶ (ä½ åœ¨è¿™é‡Œï¼)
2. ğŸš€ é˜…è¯»"3 æ­¥å¿«é€Ÿå¯åŠ¨"éƒ¨åˆ†
3. ğŸ§ª æŒ‰ç…§ `TEST_CONFIG_SERVER.md` æµ‹è¯•
4. ğŸ“‹ é—®é¢˜ï¼ŸæŸ¥çœ‹"å¸¸è§é—®é¢˜é€Ÿè§£"
5. ğŸ“š æ·±å…¥ï¼Ÿé˜…è¯»å…¶ä»–è¯¦ç»†æ–‡æ¡£

---

## ğŸ” å®‰å…¨æ€§æé†’

âš ï¸ **ä»…ç”¨äºå¼€å‘ï¼**

- æœ¬æœåŠ¡å™¨æ— èº«ä»½éªŒè¯
- ä¸ä½¿ç”¨ HTTPS
- ä¸å—é€Ÿç‡é™åˆ¶
- å…è®¸ä»»ä½•æºè®¿é—®ï¼ˆCORSï¼‰

**ç”Ÿäº§ç¯å¢ƒ**: éœ€è¦æ·»åŠ è®¤è¯ã€HTTPS ç­‰

---

## ğŸ¯ æ¥ä¸‹æ¥åšä»€ä¹ˆï¼Ÿ

1. âœ… å¯åŠ¨é…ç½®æœåŠ¡å™¨
2. âœ… æ‰“å¼€ Web UI
3. âœ… åŠ è½½å’Œç¼–è¾‘é…ç½®
4. âœ… ä¿å­˜é…ç½®åˆ° JSON æ–‡ä»¶
5. ğŸš€ ï¼ˆå¯é€‰ï¼‰é‡æ–°ç¼–è¯‘å’Œçƒ§å½•åˆ° ESP32

```bash
# å½“å‡†å¤‡çƒ§å½•æ—¶
idf.py build
idf.py -p COM3 flash
```

---

## ğŸ†˜ æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜ï¼Ÿ

1. æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ (`python config_server.py`)
2. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯ (F12)
3. æŸ¥çœ‹æœåŠ¡å™¨è¾“å‡ºæ—¥å¿—
4. é˜…è¯» `TEST_CONFIG_SERVER.md` ä¸­çš„å¸¸è§é—®é¢˜

---

**Quick Reference v1.0 | 2025-12-16**

æœ€åæ›´æ–°ï¼šå®ç°å®Œæˆï¼Œæ‰€æœ‰æ–‡æ¡£å°±ä½ âœ¨
