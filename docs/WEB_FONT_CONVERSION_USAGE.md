# Web ç•Œé¢å­—ä½“è½¬æ¢åŠŸèƒ½è¯´æ˜

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

å½“ä½ åœ¨ `web_layout.html` ç•Œé¢ç‚¹å‡» **"è½¬æ¢ä¸º GFX æ ¼å¼"** æŒ‰é’®æ—¶ï¼š

1. âœ… **æµè§ˆå™¨ä¸‹è½½**: è‡ªåŠ¨ä¸‹è½½ç”Ÿæˆçš„ `.h` æ–‡ä»¶
2. âœ… **æœ¬åœ°ä¿å­˜**: åŒæ—¶è‡ªåŠ¨ä¿å­˜åˆ° `components/fonts/` ç›®å½•
3. âœ… **å³æ—¶å¯ç”¨**: ä¿å­˜åç«‹å³å¯ä»¥åœ¨ä»£ç ä¸­ä½¿ç”¨

---

## ğŸ“‹ ä½¿ç”¨æ­¥éª¤

### 1. å¯åŠ¨ Python æœåŠ¡

```powershell
python tools/ttf_to_gfx_webservice.py
```

çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºè¡¨ç¤ºæˆåŠŸï¼š
```
============================================================
TTF è½¬ GFX Web æœåŠ¡å¯åŠ¨ä¸­...
============================================================
è®¿é—®: http://localhost:5000
API ç«¯ç‚¹: http://localhost:5000/convert_ttf_to_gfx
```

### 2. æ‰“å¼€ Web ç•Œé¢

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š
```
http://192.168.2.190:8848/web_layout.html
```
æˆ–è€…æœ¬åœ°æ–‡ä»¶ï¼š
```
G:\A_BL_Project\inkScree_fuben\components\grbl_esp32s3\Grbl_Esp32\data\web_layout.html
```

### 3. è½¬æ¢å­—ä½“

1. **ä¸Šä¼  TTF å­—ä½“æ–‡ä»¶**
   - æ”¯æŒä¸­æ–‡ï¼šä»¿å®‹_GB2312.ttfã€simhei.ttf ç­‰
   - æ”¯æŒè‹±æ–‡ï¼šArial.ttfã€Comic Sans MS Bold.ttf ç­‰

2. **è¾“å…¥è¦è½¬æ¢çš„æ–‡å­—**
   ```
   æ¸©åº¦æ¹¿åº¦ç”µé‡â„ƒ%
   ```

3. **é€‰æ‹©å­—ä½“å¤§å°**
   ```
   16 (æ¨è)
   ```

4. **ç‚¹å‡» "è½¬æ¢ä¸º GFX æ ¼å¼"**

### 4. æŸ¥çœ‹ç»“æœ

è½¬æ¢æˆåŠŸåä¼šæ˜¾ç¤ºï¼š

```
âœ… è½¬æ¢æˆåŠŸï¼
å­—ç¬¦æ•°: 8
ä½å›¾å¤§å°: 256 bytes
æ–‡ä»¶å·²ä¸‹è½½åˆ°æµè§ˆå™¨

ğŸ’¾ æœ¬åœ°å·²ä¿å­˜:
G:\A_BL_Project\inkScree_fuben\components\fonts\sensor16pt7b.h
ğŸ“ æ–‡ä»¶å: sensor16pt7b.h
```

---

## ğŸ“ æ–‡ä»¶ä¿å­˜ä½ç½®

è½¬æ¢åçš„æ–‡ä»¶è‡ªåŠ¨ä¿å­˜åˆ°ï¼š
```
components/fonts/[å­—ä½“åç§°][å­—å·]pt7b.h
```

ä¾‹å¦‚ï¼š
- `components/fonts/fangsong16pt7b.h`
- `components/fonts/sensor16pt7b.h`
- `components/fonts/menu20pt7b.h`

---

## ğŸ’¡ ä½¿ç”¨ç”Ÿæˆçš„å­—ä½“

### æ–¹æ³• 1: ä½¿ç”¨ GFX å­—ä½“ï¼ˆä»…é™ ASCII æˆ–è¿ç»­å­—ç¬¦ï¼‰

```cpp
// 1. åŒ…å«å¤´æ–‡ä»¶
#include "../fonts/sensor16pt7b.h"

// 2. è®¾ç½®å­—ä½“
display.setFont(&sensor16pt7b);

// 3. æ˜¾ç¤ºæ–‡å­—
display.print("Temp: 25C");
```

âš ï¸ **æ³¨æ„**: GFX å­—ä½“ä¸é€‚åˆä¸­æ–‡ï¼ˆUnicode ä¸è¿ç»­ä¼šå¯¼è‡´èŠ±å±ï¼‰

### æ–¹æ³• 2: ä½¿ç”¨ä½å›¾æ•°ç»„ï¼ˆæ¨èä¸­æ–‡ï¼‰

å¦‚æœè¦æ˜¾ç¤ºä¸­æ–‡ï¼Œä½¿ç”¨ `generate_bitmap_arrays.py`ï¼š

```powershell
# ç¼–è¾‘ tools/generate_bitmap_arrays.py
# ä¿®æ”¹ CHARS = "æ¸©åº¦æ¹¿åº¦ç”µé‡"
python tools/generate_bitmap_arrays.py
```

ç„¶ååœ¨ä»£ç ä¸­ï¼š
```cpp
#include "../fonts/fangsong_bitmaps16pt.h"
drawFangsongBitmaps(display, 10, 50, 1);
```

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### Python æœåŠ¡åšäº†ä»€ä¹ˆ

```python
# æ¥æ”¶è¯·æ±‚
{
    "ttf_base64": "base64ç¼–ç çš„TTFæ–‡ä»¶",
    "chars": "æ¸©åº¦â„ƒ",
    "font_size": 16,
    "font_name": "sensor"
}

# å¤„ç†æµç¨‹
1. è§£ç  TTF æ–‡ä»¶
2. æ¸²æŸ“æ¯ä¸ªå­—ç¬¦ä¸ºä½å›¾
3. ç”Ÿæˆ GFX æ ¼å¼ .h æ–‡ä»¶
4. ä¿å­˜åˆ° components/fonts/
5. è¿”å›æ–‡ä»¶å†…å®¹ï¼ˆæµè§ˆå™¨ä¸‹è½½ï¼‰

# è¿”å›å“åº”
{
    "success": true,
    "h_file": "å®Œæ•´çš„.hæ–‡ä»¶å†…å®¹",
    "char_count": 4,
    "file_size": 128,
    "saved_path": "G:\\...\\components\\fonts\\sensor16pt7b.h",
    "filename": "sensor16pt7b.h"
}
```

### Web ç•Œé¢åšäº†ä»€ä¹ˆ

```javascript
// 1. è¯»å–ç”¨æˆ·ä¸Šä¼ çš„ TTF æ–‡ä»¶
const ttf_base64 = fileReader.result.split(',')[1];

// 2. å‘é€åˆ° Python æœåŠ¡
const response = await fetch('http://localhost:5000/convert_ttf_to_gfx', {
    method: 'POST',
    body: JSON.stringify({ ttf_base64, chars, font_size, font_name })
});

// 3. ä¸‹è½½æ–‡ä»¶åˆ°æµè§ˆå™¨
downloadGFXHeader(result.h_file, 'sensor16pt7b.h');

// 4. æ˜¾ç¤ºä¿å­˜è·¯å¾„
æ˜¾ç¤º: "æœ¬åœ°å·²ä¿å­˜: G:\...\components\fonts\sensor16pt7b.h"
```

---

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

| è½¬æ¢æ–¹å¼ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|---------|------|------|---------|
| **Web ç•Œé¢ + Python æœåŠ¡** | è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°<br>æµè§ˆå™¨ä¹Ÿä¸‹è½½<br>åŒé‡ä¿é™© | éœ€è¦å¯åŠ¨æœåŠ¡ | â­â­â­â­â­ æ¨è |
| **æœ¬åœ° Python è„šæœ¬** | ä¸éœ€è¦ Web<br>ç›´æ¥ç”Ÿæˆ | éœ€è¦ä¿®æ”¹è„šæœ¬ | â­â­â­â­ å¿«é€Ÿæµ‹è¯• |
| **åœ¨çº¿å·¥å…·** | æ— éœ€å®‰è£… | æ‰‹åŠ¨ä¸‹è½½<br>æ‰‹åŠ¨ç§»åŠ¨æ–‡ä»¶ | â­â­â­ å¶å°”ä½¿ç”¨ |

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: ç‚¹å‡»è½¬æ¢åæ²¡æœ‰ååº”ï¼Ÿ

**æ£€æŸ¥**:
```powershell
# 1. Python æœåŠ¡æ˜¯å¦è¿è¡Œ
# åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
#  * Running on http://127.0.0.1:5000

# 2. æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ï¼ˆæŒ‰ F12ï¼‰
# æŸ¥çœ‹ Console æ ‡ç­¾é¡µ
```

### Q2: æ˜¾ç¤º "æ— æ³•è¿æ¥åˆ° Python è½¬æ¢æœåŠ¡"ï¼Ÿ

**è§£å†³**:
```powershell
# é‡æ–°å¯åŠ¨ Python æœåŠ¡
python tools/ttf_to_gfx_webservice.py
```

### Q3: æ–‡ä»¶ä¿å­˜åˆ°å“ªé‡Œäº†ï¼Ÿ

**ä½ç½®**:
```
G:\A_BL_Project\inkScree_fuben\components\fonts\
```

æ£€æŸ¥æ–¹æ³•ï¼š
```powershell
dir components\fonts\*.h
```

### Q4: è½¬æ¢åçš„å­—ä½“æ˜¾ç¤ºèŠ±å±ï¼Ÿ

**åŸå› **: ä¸­æ–‡å­—ç¬¦çš„ Unicode ä¸è¿ç»­ï¼ŒGFX å­—ä½“æ ¼å¼ä¸é€‚åˆã€‚

**è§£å†³**: ä½¿ç”¨ä½å›¾æ•°ç»„æ–¹å¼ï¼ˆè§ä¸Šæ–‡"æ–¹æ³• 2"ï¼‰

---

## ğŸ¯ æ¨èå·¥ä½œæµç¨‹

### åœºæ™¯ 1: æ˜¾ç¤ºä¼ æ„Ÿå™¨æ•°æ®ï¼ˆè‹±æ–‡+æ•°å­—+ç¬¦å·ï¼‰

```
1. å­—ç¬¦: "Temp:0123456789.C%"
2. ä½¿ç”¨ Web ç•Œé¢è½¬æ¢
3. ä½¿ç”¨ GFX å­—ä½“æ˜¾ç¤ºï¼ˆASCII è¿ç»­ï¼Œå¯ä»¥ç”¨ï¼‰
```

### åœºæ™¯ 2: æ˜¾ç¤ºä¸­æ–‡èœå•

```
1. å­—ç¬¦: "è®¾ç½® ç¡®å®š å–æ¶ˆ è¿”å›"
2. ä½¿ç”¨ generate_bitmap_arrays.py è½¬æ¢
3. ä½¿ç”¨ä½å›¾æ–¹å¼æ˜¾ç¤ºï¼ˆé¿å… Unicode é—®é¢˜ï¼‰
```

### åœºæ™¯ 3: æ··åˆæ˜¾ç¤ºï¼ˆä¸­æ–‡ + è‹±æ–‡ï¼‰

```cpp
// ä¸­æ–‡ç”¨ä½å›¾
drawFangsongBitmaps(display, 10, 50, 1);  // "æ¸©åº¦"

// è‹±æ–‡ç”¨ GFX å­—ä½“
display.setFont(&FreeSerifBoldItalic16pt7b);
display.setCursor(50, 50);
display.print("25.5C");
```

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

- **Web æœåŠ¡**: `tools/ttf_to_gfx_webservice.py`
- **Web ç•Œé¢**: `components/grbl_esp32s3/Grbl_Esp32/data/web_layout.html`
- **ä½å›¾ç”Ÿæˆ**: `tools/generate_bitmap_arrays.py`
- **å¿«é€Ÿè½¬æ¢**: `tools/quick_convert.py`
- **å­—ä½“ç›®å½•**: `components/fonts/`

---

## âœ¨ æ€»ç»“

**ç°åœ¨çš„å·¥ä½œæµç¨‹éå¸¸ç®€å•**ï¼š

1. å¯åŠ¨ Python æœåŠ¡ï¼ˆä¸€æ¬¡ï¼‰
2. åœ¨ Web ç•Œé¢ä¸Šä¼ å­—ä½“
3. ç‚¹å‡»è½¬æ¢æŒ‰é’®
4. **è‡ªåŠ¨ä¿å­˜åˆ° components/fonts/**
5. **æµè§ˆå™¨ä¹Ÿä¸‹è½½ä¸€ä»½**
6. ç«‹å³å¯ä»¥åœ¨ä»£ç ä¸­ä½¿ç”¨

**æ— éœ€æ‰‹åŠ¨å¤åˆ¶ç²˜è´´æ–‡ä»¶ï¼** ğŸ‰
